{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"T5_summarization_for_trivia","provenance":[{"file_id":"https://github.com/huggingface/notebooks/blob/master/examples/summarization.ipynb","timestamp":1619833200151}],"collapsed_sections":[]},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.9"},"widgets":{"application/vnd.jupyter.widget-state+json":{"9821b5498c9b4f1fa514cf093bd28035":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_43ae802bee084ac6abf3e37e07f47781","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_fd4dece2340d4227adc74c33a97cc283","IPY_MODEL_233a1b9a5b6f4f74b714e3dbd51f4abe"]}},"43ae802bee084ac6abf3e37e07f47781":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fd4dece2340d4227adc74c33a97cc283":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_520ec78d7a5f4557933b1ef3596fef3e","_dom_classes":[],"description":"Downloading: ","_model_name":"FloatProgressModel","bar_style":"success","max":3413,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":3413,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d0ede5c111f345bcac3959f0f383fb8c"}},"233a1b9a5b6f4f74b714e3dbd51f4abe":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f3c729934be34a2dbce67f94806264bb","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 12.5k/? [01:59&lt;00:00, 105B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_fbe3285f3d7341099043eb903370d435"}},"520ec78d7a5f4557933b1ef3596fef3e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"d0ede5c111f345bcac3959f0f383fb8c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f3c729934be34a2dbce67f94806264bb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"fbe3285f3d7341099043eb903370d435":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"73539ffa994b4ecbbbe782f900c5c8d2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_53b6abb4fdda455fa0aaf9d0622737ec","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_07095c93743540b2bfa9cb3b737821c0","IPY_MODEL_cc44d58e2ff1485c8a89d9cacfa13c76"]}},"53b6abb4fdda455fa0aaf9d0622737ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"07095c93743540b2bfa9cb3b737821c0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_8288fcab5fd34782956538f3093fd46f","_dom_classes":[],"description":"Downloading: ","_model_name":"FloatProgressModel","bar_style":"success","max":1408,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1408,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8f3f46da89544ea490129ec49db6f5ae"}},"cc44d58e2ff1485c8a89d9cacfa13c76":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b159d88044b54ae58b20df3e4ae443cd","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 13.6k/? [00:00&lt;00:00, 137kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ae746762ce074b34af960954b2c77bab"}},"8288fcab5fd34782956538f3093fd46f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8f3f46da89544ea490129ec49db6f5ae":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b159d88044b54ae58b20df3e4ae443cd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"ae746762ce074b34af960954b2c77bab":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fc9545f6fd12430cb68abb3977b960dc":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e54ed53663b3421ebcc224f3d7358bae","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_4f9742178d5c4cf5857cdffaf02c5d02","IPY_MODEL_9a0e7b5c9488466f8e407ca78198e8c1"]}},"e54ed53663b3421ebcc224f3d7358bae":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4f9742178d5c4cf5857cdffaf02c5d02":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_26ac4f0d683342af818d43f2535635a3","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":2665779500,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":2665779500,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_226542eaa1804db49e7711ad06403103"}},"9a0e7b5c9488466f8e407ca78198e8c1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_7c0f98ab55954ba78bd3efc3b7f03934","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 2.67G/2.67G [01:58&lt;00:00, 22.6MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c59eac74c4df43cca485bdf6629d8cae"}},"26ac4f0d683342af818d43f2535635a3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"226542eaa1804db49e7711ad06403103":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7c0f98ab55954ba78bd3efc3b7f03934":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c59eac74c4df43cca485bdf6629d8cae":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7bedf8eb301841178ce42626aee2ea71":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_61d0b3e4e5584ea68924bb67c9846b1f","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_534f108d8b544d10912bf20f6d69f948","IPY_MODEL_a033f2e7735041b1b40c70ca18e91e9d"]}},"61d0b3e4e5584ea68924bb67c9846b1f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"534f108d8b544d10912bf20f6d69f948":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_512d46b6e14348a2bf5ceae7ff5c11a1","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ffa0f8e437834015ade6be5c7aeb0f6b"}},"a033f2e7735041b1b40c70ca18e91e9d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_9c69e6bb6a5a45fb8d0ec3b4d7b4197a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 138384/0 [00:59&lt;00:00, 3049.62 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0e8d62ff0fd44f69a7d00fa3ab28f90c"}},"512d46b6e14348a2bf5ceae7ff5c11a1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ffa0f8e437834015ade6be5c7aeb0f6b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9c69e6bb6a5a45fb8d0ec3b4d7b4197a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"0e8d62ff0fd44f69a7d00fa3ab28f90c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"99a682610d62487abd9de3d2a3c6b78c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_edb7cf3f363443ffa2a6a41feb067889","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_e128b42baa4b461790a92e1ec7499493","IPY_MODEL_4a420183ba7c47069111d9542e5c9cc9"]}},"edb7cf3f363443ffa2a6a41feb067889":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e128b42baa4b461790a92e1ec7499493":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f58924da0a7a4057a03be58dbb57b2ba","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8196c103e7bb4c61b57cc28eae97b400"}},"4a420183ba7c47069111d9542e5c9cc9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f2aa14d9002f4bd68113e37d6cdb1d06","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 18669/0 [00:07&lt;00:00, 2071.51 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_932c0c4886ba4430aafe0495eb07ee86"}},"f58924da0a7a4057a03be58dbb57b2ba":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8196c103e7bb4c61b57cc28eae97b400":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f2aa14d9002f4bd68113e37d6cdb1d06":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"932c0c4886ba4430aafe0495eb07ee86":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9c205bdcbe2d4470a0417a3d3f7b394f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_ff0564c41e3c413e9c1dae6abcc4a481","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_9e49f8f6ee4040d39d06f06d590d95d2","IPY_MODEL_43a4f7187fa1440d989f2e4b18804b3a"]}},"ff0564c41e3c413e9c1dae6abcc4a481":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9e49f8f6ee4040d39d06f06d590d95d2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5b89f30a16f946b8a5d0cec2af357ee0","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c66a8df8dc0a4f67a81a8aab5aa20f55"}},"43a4f7187fa1440d989f2e4b18804b3a":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_31364288ed1c41ebb1a1ff9a95f40487","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 17210/0 [00:04&lt;00:00, 4470.93 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a913ff980c724e05b7603d1210040037"}},"5b89f30a16f946b8a5d0cec2af357ee0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"c66a8df8dc0a4f67a81a8aab5aa20f55":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"31364288ed1c41ebb1a1ff9a95f40487":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a913ff980c724e05b7603d1210040037":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d9639796910643468c6d2c7771b19017":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_dd126c1314bd47f987296e176b83629c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_21bc4b6d68564763a0c96ebfa0b0eba2","IPY_MODEL_97c9a90990dc45f1a6b155cbb57c02fe"]}},"dd126c1314bd47f987296e176b83629c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"21bc4b6d68564763a0c96ebfa0b0eba2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_18c9300c24e7483ab51d8b4a82c6d2f4","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1197,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1197,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ceea578758c3438cbf3878446c689ccb"}},"97c9a90990dc45f1a6b155cbb57c02fe":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b0284a0331f14053a497b7a6daf2a9a4","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.20k/1.20k [06:11&lt;00:00, 3.22B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_45b08362f04341f183e6622e723e8e78"}},"18c9300c24e7483ab51d8b4a82c6d2f4":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ceea578758c3438cbf3878446c689ccb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b0284a0331f14053a497b7a6daf2a9a4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"45b08362f04341f183e6622e723e8e78":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2af0851925374a3da9add8813f1a2c4a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_cb7d1145a1454eaf821e3d9530870ba5","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_d007c8de1a724f9288905893f50519a0","IPY_MODEL_a74c22d50fc84005b48d362b30119503"]}},"cb7d1145a1454eaf821e3d9530870ba5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d007c8de1a724f9288905893f50519a0":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_8d2cc42563f148ab98e0c7b43ce90cb0","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":791656,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":791656,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a0557a9df2b44b4d98376f83b1a200bf"}},"a74c22d50fc84005b48d362b30119503":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3cf77d9027864f9f85e77adb415d6340","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 792k/792k [00:00&lt;00:00, 4.46MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_39d69ae6408e4b12a4594fb1a73135f5"}},"8d2cc42563f148ab98e0c7b43ce90cb0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a0557a9df2b44b4d98376f83b1a200bf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3cf77d9027864f9f85e77adb415d6340":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"39d69ae6408e4b12a4594fb1a73135f5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1699f86c6f5b4d50ba6044b80a7294e6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_30721643792b46599140e8f89746de57","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_0dd210c63ec241aaa9df982952c12ac4","IPY_MODEL_8cdd38de4d4f4d83a0bdfe84f6375156"]}},"30721643792b46599140e8f89746de57":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0dd210c63ec241aaa9df982952c12ac4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_098cc4877bca4930b5a6f9e29935189e","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1389353,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1389353,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7fafee33665640bd85a3c49f3de975c6"}},"8cdd38de4d4f4d83a0bdfe84f6375156":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_07bc572153b04005bd3516cafdec8741","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.39M/1.39M [06:10&lt;00:00, 3.75kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_638e52bf4db4474eac94089445756608"}},"098cc4877bca4930b5a6f9e29935189e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7fafee33665640bd85a3c49f3de975c6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"07bc572153b04005bd3516cafdec8741":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"638e52bf4db4474eac94089445756608":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"50da99927db1486fa5937a038e2754ff":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_3e2f14f5e726495cbb0666d1253ec5d5","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8054304e3f7e424c96563c88f83612f6","IPY_MODEL_e1cc765028e44581879e9e44c6fb5ac6"]}},"3e2f14f5e726495cbb0666d1253ec5d5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8054304e3f7e424c96563c88f83612f6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_907e67a62f064f57a0e751e2c2d71865","_dom_classes":[],"description":"100%","_model_name":"FloatProgressModel","bar_style":"success","max":139,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":139,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_dfc9c453c7ce40aabb8b6c87053a3a58"}},"e1cc765028e44581879e9e44c6fb5ac6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ba84b456137e4a2c95b5762122b71154","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 139/139 [00:40&lt;00:00,  3.46ba/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f150181f0ed441e6b3712f64bc2ac5a0"}},"907e67a62f064f57a0e751e2c2d71865":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"dfc9c453c7ce40aabb8b6c87053a3a58":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ba84b456137e4a2c95b5762122b71154":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f150181f0ed441e6b3712f64bc2ac5a0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ac174b9993884a2f8380641c8a72dde6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_96c87b8a3ab84a579db79c28efbe8cf5","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_f1034070044949f9a32209902751efcc","IPY_MODEL_23b0aac04cb145718781d47c3c5d213b"]}},"96c87b8a3ab84a579db79c28efbe8cf5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f1034070044949f9a32209902751efcc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b7f7a79c429e455bb5056173ca5a3ee9","_dom_classes":[],"description":"100%","_model_name":"FloatProgressModel","bar_style":"success","max":19,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":19,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_942f0e92135e49acb2aa083b19b0e7eb"}},"23b0aac04cb145718781d47c3c5d213b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_94e007148d3c4022b5ab6b018a82ed3c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 19/19 [00:04&lt;00:00,  3.97ba/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d6d1d7875bb342c19f3ec41dae349427"}},"b7f7a79c429e455bb5056173ca5a3ee9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"942f0e92135e49acb2aa083b19b0e7eb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"94e007148d3c4022b5ab6b018a82ed3c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d6d1d7875bb342c19f3ec41dae349427":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"df98f79580064cfab3b20615235bb797":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_0184c6bd418d45adb13e3363903bdf0a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_bcb44533bc974507a9e830c60dcadf42","IPY_MODEL_8a1de28c3dfa464488240f4701798239"]}},"0184c6bd418d45adb13e3363903bdf0a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bcb44533bc974507a9e830c60dcadf42":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_82a61dc2e7034b9eb2040682c08c53d5","_dom_classes":[],"description":"100%","_model_name":"FloatProgressModel","bar_style":"success","max":18,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":18,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f916d018393f40f6975f3348164dfe84"}},"8a1de28c3dfa464488240f4701798239":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_58454e3ff777422db1c8969c93d1aa7c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 18/18 [02:02&lt;00:00,  6.82s/ba]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_83d11d837160466a93b8a68d81a1e190"}},"82a61dc2e7034b9eb2040682c08c53d5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f916d018393f40f6975f3348164dfe84":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"58454e3ff777422db1c8969c93d1aa7c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"83d11d837160466a93b8a68d81a1e190":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"274deb52a9b6465c8c1e9e199cb62f22":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_669d1b44b94b4cb48d9a765b4c0c434b","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_390f2ea57f6b458e87695fdc1d9284ad","IPY_MODEL_30d6e0e27de74c7aa071b32105ffd3a0"]}},"669d1b44b94b4cb48d9a765b4c0c434b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"390f2ea57f6b458e87695fdc1d9284ad":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_8062cf8e6ae245ae9d1984c31522d9da","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":242065649,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":242065649,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ae0a9909aa5c4e6ea5d559d8ea642d82"}},"30d6e0e27de74c7aa071b32105ffd3a0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_45f3aecd729948b18fddeb3fea8bcce3","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 242M/242M [00:06&lt;00:00, 36.4MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f9a3057c6f5148398bc4b40873ce04d2"}},"8062cf8e6ae245ae9d1984c31522d9da":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ae0a9909aa5c4e6ea5d559d8ea642d82":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"45f3aecd729948b18fddeb3fea8bcce3":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f9a3057c6f5148398bc4b40873ce04d2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"id":"MOsHUjgdIrIW","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1620060432750,"user_tz":420,"elapsed":10925,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"2e4195db-4086-40e4-d6b0-c73c417fbe77"},"source":["!pip install datasets transformers nltk\n","!git clone https://github.com/mandarjoshi90/triviaqa.git ## for evaluation script"],"execution_count":1,"outputs":[{"output_type":"stream","text":["Collecting datasets\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/46/1a/b9f9b3bfef624686ae81c070f0a6bb635047b17cdb3698c7ad01281e6f9a/datasets-1.6.2-py3-none-any.whl (221kB)\n","\u001b[K     |████████████████████████████████| 225kB 15.3MB/s \n","\u001b[?25hCollecting transformers\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/d8/b2/57495b5309f09fa501866e225c84532d1fd89536ea62406b2181933fb418/transformers-4.5.1-py3-none-any.whl (2.1MB)\n","\u001b[K     |████████████████████████████████| 2.1MB 14.4MB/s \n","\u001b[?25hRequirement already satisfied: nltk in /usr/local/lib/python3.7/dist-packages (3.2.5)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from datasets) (1.19.5)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (2.23.0)\n","Collecting huggingface-hub<0.1.0\n","  Downloading https://files.pythonhosted.org/packages/a1/88/7b1e45720ecf59c6c6737ff332f41c955963090a18e72acbcbeac6b25e86/huggingface_hub-0.0.8-py3-none-any.whl\n","Requirement already satisfied: tqdm<4.50.0,>=4.27 in /usr/local/lib/python3.7/dist-packages (from datasets) (4.41.1)\n","Requirement already satisfied: dill in /usr/local/lib/python3.7/dist-packages (from datasets) (0.3.3)\n","Requirement already satisfied: multiprocess in /usr/local/lib/python3.7/dist-packages (from datasets) (0.70.11.1)\n","Requirement already satisfied: importlib-metadata; python_version < \"3.8\" in /usr/local/lib/python3.7/dist-packages (from datasets) (3.10.1)\n","Requirement already satisfied: pyarrow>=1.0.0<4.0.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (3.0.0)\n","Collecting xxhash\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/7d/4f/0a862cad26aa2ed7a7cd87178cbbfa824fc1383e472d63596a0d018374e7/xxhash-2.0.2-cp37-cp37m-manylinux2010_x86_64.whl (243kB)\n","\u001b[K     |████████████████████████████████| 245kB 53.2MB/s \n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from datasets) (1.1.5)\n","Collecting fsspec\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/e9/91/2ef649137816850fa4f4c97c6f2eabb1a79bf0aa2c8ed198e387e373455e/fsspec-2021.4.0-py3-none-any.whl (108kB)\n","\u001b[K     |████████████████████████████████| 112kB 54.0MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from datasets) (20.9)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.0.12)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2019.12.20)\n","Collecting tokenizers<0.11,>=0.10.1\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/ae/04/5b870f26a858552025a62f1649c20d29d2672c02ff3c3fb4c688ca46467a/tokenizers-0.10.2-cp37-cp37m-manylinux2010_x86_64.whl (3.3MB)\n","\u001b[K     |████████████████████████████████| 3.3MB 45.9MB/s \n","\u001b[?25hCollecting sacremoses\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/75/ee/67241dc87f266093c533a2d4d3d69438e57d7a90abb216fa076e7d475d4a/sacremoses-0.0.45-py3-none-any.whl (895kB)\n","\u001b[K     |████████████████████████████████| 901kB 33.1MB/s \n","\u001b[?25hRequirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from nltk) (1.15.0)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2020.12.5)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2.10)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version < \"3.8\"->datasets) (3.4.1)\n","Requirement already satisfied: typing-extensions>=3.6.4; python_version < \"3.8\" in /usr/local/lib/python3.7/dist-packages (from importlib-metadata; python_version < \"3.8\"->datasets) (3.7.4.3)\n","Requirement already satisfied: pytz>=2017.2 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2018.9)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2.8.1)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->datasets) (2.4.7)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (1.0.1)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers) (7.1.2)\n","Installing collected packages: huggingface-hub, xxhash, fsspec, datasets, tokenizers, sacremoses, transformers\n","Successfully installed datasets-1.6.2 fsspec-2021.4.0 huggingface-hub-0.0.8 sacremoses-0.0.45 tokenizers-0.10.2 transformers-4.5.1 xxhash-2.0.2\n","Cloning into 'triviaqa'...\n","remote: Enumerating objects: 67, done.\u001b[K\n","remote: Total 67 (delta 0), reused 0 (delta 0), pack-reused 67\u001b[K\n","Unpacking objects: 100% (67/67), done.\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"rEJBSTyZIrIb"},"source":["### Fine-tuning T5 on trivia dataset"]},{"cell_type":"code","metadata":{"id":"RUgSRs8SlQ0S","executionInfo":{"status":"ok","timestamp":1620060432752,"user_tz":420,"elapsed":10921,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}}},"source":["model_checkpoint = \"t5-small\""],"execution_count":2,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"4RRkXuteIrIh"},"source":["This notebook is built to run  with any model checkpoint from the [Model Hub](https://huggingface.co/models) as long as that model has a sequence-to-sequence version in the Transformers library. Here we picked the [`t5-small`](https://huggingface.co/t5-small) checkpoint. "]},{"cell_type":"markdown","metadata":{"id":"whPRbBNbIrIl"},"source":["## Loading the dataset"]},{"cell_type":"markdown","metadata":{"id":"W7QYTpxXIrIl"},"source":["Use the [HuggingFace Datasets](https://github.com/huggingface/datasets) library to download the data. This can be done with the function `load_dataset`."]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":218,"referenced_widgets":["9821b5498c9b4f1fa514cf093bd28035","43ae802bee084ac6abf3e37e07f47781","fd4dece2340d4227adc74c33a97cc283","233a1b9a5b6f4f74b714e3dbd51f4abe","520ec78d7a5f4557933b1ef3596fef3e","d0ede5c111f345bcac3959f0f383fb8c","f3c729934be34a2dbce67f94806264bb","fbe3285f3d7341099043eb903370d435","73539ffa994b4ecbbbe782f900c5c8d2","53b6abb4fdda455fa0aaf9d0622737ec","07095c93743540b2bfa9cb3b737821c0","cc44d58e2ff1485c8a89d9cacfa13c76","8288fcab5fd34782956538f3093fd46f","8f3f46da89544ea490129ec49db6f5ae","b159d88044b54ae58b20df3e4ae443cd","ae746762ce074b34af960954b2c77bab","fc9545f6fd12430cb68abb3977b960dc","e54ed53663b3421ebcc224f3d7358bae","4f9742178d5c4cf5857cdffaf02c5d02","9a0e7b5c9488466f8e407ca78198e8c1","26ac4f0d683342af818d43f2535635a3","226542eaa1804db49e7711ad06403103","7c0f98ab55954ba78bd3efc3b7f03934","c59eac74c4df43cca485bdf6629d8cae","7bedf8eb301841178ce42626aee2ea71","61d0b3e4e5584ea68924bb67c9846b1f","534f108d8b544d10912bf20f6d69f948","a033f2e7735041b1b40c70ca18e91e9d","512d46b6e14348a2bf5ceae7ff5c11a1","ffa0f8e437834015ade6be5c7aeb0f6b","9c69e6bb6a5a45fb8d0ec3b4d7b4197a","0e8d62ff0fd44f69a7d00fa3ab28f90c","99a682610d62487abd9de3d2a3c6b78c","edb7cf3f363443ffa2a6a41feb067889","e128b42baa4b461790a92e1ec7499493","4a420183ba7c47069111d9542e5c9cc9","f58924da0a7a4057a03be58dbb57b2ba","8196c103e7bb4c61b57cc28eae97b400","f2aa14d9002f4bd68113e37d6cdb1d06","932c0c4886ba4430aafe0495eb07ee86","9c205bdcbe2d4470a0417a3d3f7b394f","ff0564c41e3c413e9c1dae6abcc4a481","9e49f8f6ee4040d39d06f06d590d95d2","43a4f7187fa1440d989f2e4b18804b3a","5b89f30a16f946b8a5d0cec2af357ee0","c66a8df8dc0a4f67a81a8aab5aa20f55","31364288ed1c41ebb1a1ff9a95f40487","a913ff980c724e05b7603d1210040037"]},"id":"IreSlFmlIrIm","executionInfo":{"status":"ok","timestamp":1620060844927,"user_tz":420,"elapsed":419330,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"b5a9c561-42d7-4305-ff4e-f8d2ed569c21"},"source":["from datasets import load_dataset\n","\n","raw_datasets = load_dataset('trivia_qa', 'rc.nocontext')"],"execution_count":3,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"9821b5498c9b4f1fa514cf093bd28035","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=3413.0, style=ProgressStyle(description…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"73539ffa994b4ecbbbe782f900c5c8d2","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=1408.0, style=ProgressStyle(description…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Downloading and preparing dataset trivia_qa/rc.nocontext (download: 2.48 GiB, generated: 120.42 MiB, post-processed: Unknown size, total: 2.60 GiB) to /root/.cache/huggingface/datasets/trivia_qa/rc.nocontext/1.1.0/9977a5d6f72acfd92f587de052403e8138b43bb0d1ce595016c3baf7e14deba6...\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"fc9545f6fd12430cb68abb3977b960dc","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=2665779500.0, style=ProgressStyle(descr…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"7bedf8eb301841178ce42626aee2ea71","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\r"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"99a682610d62487abd9de3d2a3c6b78c","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\r"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"9c205bdcbe2d4470a0417a3d3f7b394f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\rDataset trivia_qa downloaded and prepared to /root/.cache/huggingface/datasets/trivia_qa/rc.nocontext/1.1.0/9977a5d6f72acfd92f587de052403e8138b43bb0d1ce595016c3baf7e14deba6. Subsequent calls will reuse this data.\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"RzfPtOMoIrIu"},"source":["The `dataset` object itself is [`DatasetDict`](https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasetdict), which contains one key for the training, validation and test set:"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"GWiVUF0jIrIv","executionInfo":{"status":"ok","timestamp":1620060845040,"user_tz":420,"elapsed":416872,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"d5887912-20d4-4479-fab7-10344015deb9"},"source":["raw_datasets"],"execution_count":4,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DatasetDict({\n","    train: Dataset({\n","        features: ['question', 'question_id', 'question_source', 'entity_pages', 'search_results', 'answer'],\n","        num_rows: 138384\n","    })\n","    validation: Dataset({\n","        features: ['question', 'question_id', 'question_source', 'entity_pages', 'search_results', 'answer'],\n","        num_rows: 18669\n","    })\n","    test: Dataset({\n","        features: ['question', 'question_id', 'question_source', 'entity_pages', 'search_results', 'answer'],\n","        num_rows: 17210\n","    })\n","})"]},"metadata":{"tags":[]},"execution_count":4}]},{"cell_type":"markdown","metadata":{"id":"u3EtYfeHIrIz"},"source":["To access an actual element, you need to select a split first, then give an index:"]},{"cell_type":"code","metadata":{"id":"X6HrpprwIrIz","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1620060845040,"user_tz":420,"elapsed":340681,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"9fd9fb7f-1061-47f2-886f-0bbf5d95ca12"},"source":["raw_datasets[\"train\"][0]"],"execution_count":5,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'answer': {'aliases': ['(Harry) Sinclair Lewis',\n","   'Harry Sinclair Lewis',\n","   'Lewis, (Harry) Sinclair',\n","   'Grace Hegger',\n","   'Sinclair Lewis'],\n","  'matched_wiki_entity_name': '',\n","  'normalized_aliases': ['grace hegger',\n","   'lewis harry sinclair',\n","   'harry sinclair lewis',\n","   'sinclair lewis'],\n","  'normalized_matched_wiki_entity_name': '',\n","  'normalized_value': 'sinclair lewis',\n","  'type': 'WikipediaEntity',\n","  'value': 'Sinclair Lewis'},\n"," 'entity_pages': {'doc_source': [],\n","  'filename': [],\n","  'title': [],\n","  'wiki_context': []},\n"," 'question': 'Which American-born Sinclair won the Nobel Prize for Literature in 1930?',\n"," 'question_id': 'tc_1',\n"," 'question_source': 'http://www.triviacountry.com/',\n"," 'search_results': {'description': [],\n","  'filename': [],\n","  'rank': [],\n","  'search_context': [],\n","  'title': [],\n","  'url': []}}"]},"metadata":{"tags":[]},"execution_count":5}]},{"cell_type":"markdown","metadata":{"id":"WHUmphG3IrI3"},"source":["To get a sense of what the data looks like, the following function will show some examples picked randomly in the dataset."]},{"cell_type":"code","metadata":{"id":"i3j8APAoIrI3","executionInfo":{"status":"ok","timestamp":1620060845302,"user_tz":420,"elapsed":251,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}}},"source":["import datasets\n","import random\n","import pandas as pd\n","from IPython.display import display, HTML\n","\n","def show_random_elements(dataset, num_examples=5):\n","    assert num_examples <= len(dataset), \"Can't pick more elements than there are in the dataset.\"\n","    picks = []\n","    for _ in range(num_examples):\n","        pick = random.randint(0, len(dataset)-1)\n","        while pick in picks:\n","            pick = random.randint(0, len(dataset)-1)\n","        picks.append(pick)\n","    \n","    df = pd.DataFrame(dataset[picks])\n","    for column, typ in dataset.features.items():\n","        if isinstance(typ, datasets.ClassLabel):\n","            df[column] = df[column].transform(lambda i: typ.names[i])\n","    display(HTML(df.to_html()))"],"execution_count":6,"outputs":[]},{"cell_type":"code","metadata":{"id":"SZy5tRB_IrI7","colab":{"base_uri":"https://localhost:8080/","height":1000},"executionInfo":{"status":"ok","timestamp":1620060845457,"user_tz":420,"elapsed":394,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"7d47a03e-28f4-4884-92f7-be132bf11759"},"source":["show_random_elements(raw_datasets[\"train\"])"],"execution_count":7,"outputs":[{"output_type":"display_data","data":{"text/html":["<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>answer</th>\n","      <th>entity_pages</th>\n","      <th>question</th>\n","      <th>question_id</th>\n","      <th>question_source</th>\n","      <th>search_results</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>{'aliases': ['Russia (1991-1993)', 'Оросын Холбооны Улс', 'Etymology of Russia', 'The Russian federation', 'Рәсәй', 'ISO 3166-1:RU', 'Russia (1990-1993)', 'Ресей', 'Novaya russia', 'Росси́я', 'Раҫҫей', 'Российская Федерация', 'Poccnr', 'Росія', 'Ородой Холбооной Улас', 'России', 'The Russian Federation', 'Russsia', 'Russian (citizen)', 'Росси́йская Федера́ция', 'Урысей', 'Арассыыйа', 'Rossiyskaya Federatsiya', 'Оьрсийн Федераций', 'Russian-born', 'Аьрасат', 'Russia (Federation)', 'POCCNR', 'Northern Russia', 'Federation of Russia', 'Russia (country)', 'Рочму', 'Ресей Федерациясы', 'Venaja', 'Русия', 'Урыстәыла', 'Resey', 'Россия', 'Wildlife of Russia', 'The Country Russia', 'Уæрæсе', 'Venaejae', 'Russian federation', 'Russie', 'Russia', 'Rossijskaja Federatsija', 'RUSSIA', 'Ryssland', 'Russian Federation', 'Russiya', 'Русија', 'RusSia', 'Орсин Ниицән', 'Russland', 'Рузмастор', 'RussiA'], 'normalized_aliases': ['российская федерация', 'русија', 'ресей', 'northern russia', 'novaya russia', 'russie', 'арассыыйа', 'russsia', 'урысей', 'россии', 'russian federation', 'ородой холбооной улас', 'russia 1990 1993', 'росси́йская федера́ция', 'росси́я', 'оьрсийн федераций', 'аьрасат', 'урыстәыла', 'resey', 'россия', 'wildlife of russia', 'country russia', 'etymology of russia', 'росія', 'rossijskaja federatsija', 'рочму', 'russian born', 'раҫҫей', 'russian citizen', 'venaja', 'русия', 'russia', 'federation of russia', 'poccnr', 'russia country', 'venaejae', 'орсин ниицән', 'russia 1991 1993', 'rossiyskaya federatsiya', 'ресей федерациясы', 'russia federation', 'оросын холбооны улс', 'рузмастор', 'russiya', 'ryssland', 'уæрæсе', 'russland', 'рәсәй', 'iso 3166 1 ru'], 'matched_wiki_entity_name': '', 'normalized_matched_wiki_entity_name': '', 'normalized_value': 'russia', 'type': 'WikipediaEntity', 'value': 'Russia'}</td>\n","      <td>{'doc_source': [], 'filename': [], 'title': [], 'wiki_context': []}</td>\n","      <td>Tatiana Day is celebrated in January in which country?</td>\n","      <td>qb_146</td>\n","      <td>http://www.quizballs.com/</td>\n","      <td>{'description': [], 'filename': [], 'rank': [], 'search_context': [], 'title': [], 'url': []}</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>{'aliases': ['Independence Day of Ecuador', 'Equadorians', 'Ecuadorean', 'Name of Ecuador', 'Ecuador', 'People of Ecuador', 'Republic of Ecuador', 'Regions of Ecuador', 'Independence Day (Ecuador)', 'Ecuadorian Independence Day', 'Administrative divisions of Ecuador', 'Ecuadoreans', 'Ecquador', 'Subdivisions of Ecuador', 'Equador', 'Zones of Ecuador', 'ISO 3166-1:EC', 'Republica del Ecuador', 'República del Ecuador'], 'normalized_aliases': ['ecquador', 'ecuadorean', 'zones of ecuador', 'republica del ecuador', 'independence day of ecuador', 'equador', 'subdivisions of ecuador', 'name of ecuador', 'iso 3166 1 ec', 'regions of ecuador', 'ecuadorian independence day', 'people of ecuador', 'ecuador', 'republic of ecuador', 'equadorians', 'independence day ecuador', 'administrative divisions of ecuador', 'ecuadoreans', 'república del ecuador'], 'matched_wiki_entity_name': '', 'normalized_matched_wiki_entity_name': '', 'normalized_value': 'ecuador', 'type': 'WikipediaEntity', 'value': 'Ecuador'}</td>\n","      <td>{'doc_source': [], 'filename': [], 'title': [], 'wiki_context': []}</td>\n","      <td>Which country in the Americas is named after a line on the map?</td>\n","      <td>sfq_731</td>\n","      <td>www.sfquiz.org.uk</td>\n","      <td>{'description': [], 'filename': [], 'rank': [], 'search_context': [], 'title': [], 'url': []}</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>{'aliases': ['The Man of Steel', 'Man of Steel (disambiguation)', 'Man of Steel', 'Man of steel', 'The man of steel'], 'normalized_aliases': ['man of steel disambiguation', 'man of steel'], 'matched_wiki_entity_name': '', 'normalized_matched_wiki_entity_name': '', 'normalized_value': 'man of steel', 'type': 'WikipediaEntity', 'value': 'Man of Steel'}</td>\n","      <td>{'doc_source': [], 'filename': [], 'title': [], 'wiki_context': []}</td>\n","      <td>In which major film of 2014 did Henry Cavill play the title character?</td>\n","      <td>dpql_4981</td>\n","      <td>https://derbyshirepubquizleague.wordpress.com/</td>\n","      <td>{'description': [], 'filename': [], 'rank': [], 'search_context': [], 'title': [], 'url': []}</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>{'aliases': ['Siamese Children'], 'normalized_aliases': ['siamese children'], 'matched_wiki_entity_name': '', 'normalized_matched_wiki_entity_name': '', 'normalized_value': 'siamese children', 'type': 'FreeForm', 'value': 'Siamese Children'}</td>\n","      <td>{'doc_source': [], 'filename': [], 'title': [], 'wiki_context': []}</td>\n","      <td>Kenny Ball and his Jazzmen's 1962 hit was called March of the ... what?</td>\n","      <td>bb_7432</td>\n","      <td>http://www.businessballs.com/</td>\n","      <td>{'description': [], 'filename': [], 'rank': [], 'search_context': [], 'title': [], 'url': []}</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>{'aliases': ['Edwin Hubble', 'E. Hubble', 'Hubble, Edwin Powell', 'Edwin P. Hubble', 'Edwin Powell Hubble'], 'normalized_aliases': ['e hubble', 'edwin p hubble', 'edwin powell hubble', 'edwin hubble', 'hubble edwin powell'], 'matched_wiki_entity_name': '', 'normalized_matched_wiki_entity_name': '', 'normalized_value': 'edwin hubble', 'type': 'WikipediaEntity', 'value': 'Edwin Hubble'}</td>\n","      <td>{'doc_source': [], 'filename': [], 'title': [], 'wiki_context': []}</td>\n","      <td>\"In a letter written in 1924, who wrote \"\"You will be interested to hear that I have found a Cepheid variable in the Andromeda Nebula\"\" and transformed our view of the universe forever?\"</td>\n","      <td>tb_1892</td>\n","      <td>http://triviabug.com/q-and-a-quizzes/</td>\n","      <td>{'description': [], 'filename': [], 'rank': [], 'search_context': [], 'title': [], 'url': []}</td>\n","    </tr>\n","  </tbody>\n","</table>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"n9qywopnIrJH"},"source":["## Preprocessing the data"]},{"cell_type":"markdown","metadata":{"id":"YVx71GdAIrJH"},"source":["`Tokenizer` tokenizes the inputs and format it into what the model expects."]},{"cell_type":"code","metadata":{"id":"eXNLu_-nIrJI","colab":{"base_uri":"https://localhost:8080/","height":164,"referenced_widgets":["d9639796910643468c6d2c7771b19017","dd126c1314bd47f987296e176b83629c","21bc4b6d68564763a0c96ebfa0b0eba2","97c9a90990dc45f1a6b155cbb57c02fe","18c9300c24e7483ab51d8b4a82c6d2f4","ceea578758c3438cbf3878446c689ccb","b0284a0331f14053a497b7a6daf2a9a4","45b08362f04341f183e6622e723e8e78","2af0851925374a3da9add8813f1a2c4a","cb7d1145a1454eaf821e3d9530870ba5","d007c8de1a724f9288905893f50519a0","a74c22d50fc84005b48d362b30119503","8d2cc42563f148ab98e0c7b43ce90cb0","a0557a9df2b44b4d98376f83b1a200bf","3cf77d9027864f9f85e77adb415d6340","39d69ae6408e4b12a4594fb1a73135f5","1699f86c6f5b4d50ba6044b80a7294e6","30721643792b46599140e8f89746de57","0dd210c63ec241aaa9df982952c12ac4","8cdd38de4d4f4d83a0bdfe84f6375156","098cc4877bca4930b5a6f9e29935189e","7fafee33665640bd85a3c49f3de975c6","07bc572153b04005bd3516cafdec8741","638e52bf4db4474eac94089445756608"]},"executionInfo":{"status":"ok","timestamp":1620060846599,"user_tz":420,"elapsed":1533,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"d5770954-5e93-437f-8b81-514b8c993e28"},"source":["from transformers import AutoTokenizer\n","    \n","tokenizer = AutoTokenizer.from_pretrained(model_checkpoint)"],"execution_count":8,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d9639796910643468c6d2c7771b19017","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=1197.0, style=ProgressStyle(description…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2af0851925374a3da9add8813f1a2c4a","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=791656.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1699f86c6f5b4d50ba6044b80a7294e6","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=1389353.0, style=ProgressStyle(descript…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"a5hBlsrHIrJL","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1620061943290,"user_tz":420,"elapsed":230,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"cad8b9ca-3890-42e8-a1ae-d1471faaf1a5"},"source":["tokenizer(\"Hello, this is one sentence!\")"],"execution_count":42,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'input_ids': [8774, 6, 48, 19, 80, 7142, 55, 1], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1]}"]},"metadata":{"tags":[]},"execution_count":42}]},{"cell_type":"code","metadata":{"id":"Q81zlI9ZlQ0Y","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1620061943764,"user_tz":420,"elapsed":252,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"599d9585-b9f0-47cf-dd30-0f22e65fc2b3"},"source":["tokenizer([\"Hello, this is one sentence!\", \"This is another sentence.\"])"],"execution_count":43,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'input_ids': [[8774, 6, 48, 19, 80, 7142, 55, 1], [100, 19, 430, 7142, 5, 1]], 'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1]]}"]},"metadata":{"tags":[]},"execution_count":43}]},{"cell_type":"markdown","metadata":{"id":"eADnFzeilQ0Z"},"source":["To prepare the targets for our model, we need to tokenize them inside the `as_target_tokenizer` context manager. This will make sure the tokenizer uses the special tokens corresponding to the targets:"]},{"cell_type":"code","metadata":{"id":"JG4opbcglQ0Z","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1620061949194,"user_tz":420,"elapsed":273,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"ca18139d-3ee7-494f-b824-04383bac9515"},"source":["with tokenizer.as_target_tokenizer():\n","    print(tokenizer([\"Hello, this is one sentence!\", \"This is another sentence.\"]))"],"execution_count":44,"outputs":[{"output_type":"stream","text":["{'input_ids': [[8774, 6, 48, 19, 80, 7142, 55, 1], [100, 19, 430, 7142, 5, 1]], 'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1]]}\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"2C0hcmp9IrJQ"},"source":["If you are using one of the five T5 checkpoints we have to prefix the inputs with \"summarize:\" (the model can also translate and it needs the prefix to know which task it has to perform)."]},{"cell_type":"code","metadata":{"id":"LSowCVhclQ0Z","executionInfo":{"status":"ok","timestamp":1620061049426,"user_tz":420,"elapsed":328,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}}},"source":["if model_checkpoint in [\"t5-small\", \"t5-base\", \"t5-larg\", \"t5-3b\", \"t5-11b\"]:\n","    prefix = \"summarize: \"\n","else:\n","    prefix = \"\""],"execution_count":12,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"ZXTUP0I8lQ0Z"},"source":["We can then write the function that will preprocess our samples. We just feed them to the `tokenizer` with the argument `truncation=True`. This will ensure that an input longer that what the model selected can handle will be truncated to the maximum length accepted by the model. The padding will be dealt with later on (in a data collator) so we pad examples to the longest length in the batch and not the whole dataset."]},{"cell_type":"code","metadata":{"id":"vc0BSBLIIrJQ","executionInfo":{"status":"ok","timestamp":1620064631705,"user_tz":420,"elapsed":296,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}}},"source":["max_input_length = 1024\n","max_target_length = 128\n","\n","def preprocess_function(examples):\n","    inputs = [prefix + doc for doc in examples['question']]\n","    model_inputs = tokenizer(inputs, max_length = max_input_length, truncation = True)\n","\n","    # Setup the tokenizer for targets\n","    with tokenizer.as_target_tokenizer():\n","        outputs = [doc['value'] for doc in examples['answer']]\n","        labels = tokenizer(outputs, max_length = max_target_length, truncation = True)\n","\n","    model_inputs[\"labels\"] = labels[\"input_ids\"]\n","    return model_inputs"],"execution_count":59,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"0lm8ozrJIrJR"},"source":["This function works with one or several examples. In the case of several examples, the tokenizer will return a list of lists for each key:"]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"qbwIHPCPOLIN","executionInfo":{"status":"ok","timestamp":1620064541062,"user_tz":420,"elapsed":228,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"567f11f7-797a-4d3a-d00d-3f15ef62caf5"},"source":["preprocess_function(raw_datasets[\"train\"][:2])"],"execution_count":56,"outputs":[{"output_type":"stream","text":["{'answer': [{'aliases': ['(Harry) Sinclair Lewis', 'Harry Sinclair Lewis', 'Lewis, (Harry) Sinclair', 'Grace Hegger', 'Sinclair Lewis'], 'normalized_aliases': ['grace hegger', 'lewis harry sinclair', 'harry sinclair lewis', 'sinclair lewis'], 'matched_wiki_entity_name': '', 'normalized_matched_wiki_entity_name': '', 'normalized_value': 'sinclair lewis', 'type': 'WikipediaEntity', 'value': 'Sinclair Lewis'}, {'aliases': ['Park Grove (1895)', 'York UA', 'Yorkish', 'UN/LOCODE:GBYRK', 'York, UK', 'Eoforwic', 'Park Grove School', 'York Ham', 'The weather in York', 'City of York', 'York, England', 'York, Yorkshire', 'York ham', 'County Borough of York', 'YORK', 'Eoferwic', 'Park Grove Primary School', 'York, North Yorkshire', 'Yoisk', 'York', 'York (England)'], 'normalized_aliases': ['york yorkshire', 'eoferwic', 'park grove primary school', 'park grove school', 'weather in york', 'park grove 1895', 'eoforwic', 'county borough of york', 'york uk', 'un locode gbyrk', 'city of york', 'york england', 'york ua', 'york ham', 'york', 'yorkish', 'yoisk', 'york north yorkshire'], 'matched_wiki_entity_name': '', 'normalized_matched_wiki_entity_name': '', 'normalized_value': 'york', 'type': 'WikipediaEntity', 'value': 'York'}], 'entity_pages': [{'doc_source': [], 'filename': [], 'title': [], 'wiki_context': []}, {'doc_source': [], 'filename': [], 'title': [], 'wiki_context': []}], 'question': ['Which American-born Sinclair won the Nobel Prize for Literature in 1930?', 'Where in England was Dame Judi Dench born?'], 'question_id': ['tc_1', 'tc_3'], 'question_source': ['http://www.triviacountry.com/', 'http://www.triviacountry.com/'], 'search_results': [{'description': [], 'filename': [], 'rank': [], 'search_context': [], 'title': [], 'url': []}, {'description': [], 'filename': [], 'rank': [], 'search_context': [], 'title': [], 'url': []}]}\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["{'input_ids': [[21603, 10, 4073, 797, 18, 7473, 8271, 7997, 751, 8, 22232, 11329, 21, 15019, 15, 16, 15559, 58, 1], [21603, 10, 2840, 16, 2789, 47, 3, 17084, 446, 5291, 3128, 524, 2170, 58, 1]], 'attention_mask': [[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]], 'labels': [[8271, 7997, 9765, 1], [1060, 1]]}"]},"metadata":{"tags":[]},"execution_count":56}]},{"cell_type":"markdown","metadata":{"id":"zS-6iXTkIrJT"},"source":["To apply this function on all the pairs of sentences in our dataset, we just use the `map` method of our `dataset` object we created earlier. This will apply the function on all the elements of all the splits in `dataset`, so our training, validation and testing data will be preprocessed in one single command."]},{"cell_type":"code","metadata":{"id":"DDtsaJeVIrJT","colab":{"base_uri":"https://localhost:8080/","height":164,"referenced_widgets":["50da99927db1486fa5937a038e2754ff","3e2f14f5e726495cbb0666d1253ec5d5","8054304e3f7e424c96563c88f83612f6","e1cc765028e44581879e9e44c6fb5ac6","907e67a62f064f57a0e751e2c2d71865","dfc9c453c7ce40aabb8b6c87053a3a58","ba84b456137e4a2c95b5762122b71154","f150181f0ed441e6b3712f64bc2ac5a0","ac174b9993884a2f8380641c8a72dde6","96c87b8a3ab84a579db79c28efbe8cf5","f1034070044949f9a32209902751efcc","23b0aac04cb145718781d47c3c5d213b","b7f7a79c429e455bb5056173ca5a3ee9","942f0e92135e49acb2aa083b19b0e7eb","94e007148d3c4022b5ab6b018a82ed3c","d6d1d7875bb342c19f3ec41dae349427","df98f79580064cfab3b20615235bb797","0184c6bd418d45adb13e3363903bdf0a","bcb44533bc974507a9e830c60dcadf42","8a1de28c3dfa464488240f4701798239","82a61dc2e7034b9eb2040682c08c53d5","f916d018393f40f6975f3348164dfe84","58454e3ff777422db1c8969c93d1aa7c","83d11d837160466a93b8a68d81a1e190"]},"executionInfo":{"status":"ok","timestamp":1620064675478,"user_tz":420,"elapsed":41114,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"8f298dfe-19a9-42d7-cb68-66a896cbd956"},"source":["tokenized_datasets = raw_datasets.map(preprocess_function, batched = True)"],"execution_count":60,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"50da99927db1486fa5937a038e2754ff","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=139.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ac174b9993884a2f8380641c8a72dde6","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=19.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"df98f79580064cfab3b20615235bb797","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=18.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"voWiw8C7IrJV"},"source":["Even better, the results are automatically cached by the 🤗 Datasets library to avoid spending time on this step the next time you run your notebook. The 🤗 Datasets library is normally smart enough to detect when the function you pass to map has changed (and thus requires to not use the cache data). For instance, it will properly detect if you change the task in the first cell and rerun the notebook. 🤗 Datasets warns you when it uses cached files, you can pass `load_from_cache_file=False` in the call to `map` to not use the cached files and force the preprocessing to be applied again.\n","\n","Note that we passed `batched=True` to encode the texts by batches together. This is to leverage the full benefit of the fast tokenizer we loaded earlier, which will use multi-threading to treat the texts in a batch concurrently."]},{"cell_type":"markdown","metadata":{"id":"545PP3o8IrJV"},"source":["## Fine-tuning the model"]},{"cell_type":"markdown","metadata":{"id":"FBiW8UpKIrJW"},"source":["Now that our data is ready, we can download the pretrained model and fine-tune it. Since our task is of the sequence-to-sequence kind, we use the `AutoModelForSeq2SeqLM` class. Like with the tokenizer, the `from_pretrained` method will download and cache the model for us."]},{"cell_type":"code","metadata":{"id":"TlqNaB8jIrJW","colab":{"base_uri":"https://localhost:8080/","height":66,"referenced_widgets":["274deb52a9b6465c8c1e9e199cb62f22","669d1b44b94b4cb48d9a765b4c0c434b","390f2ea57f6b458e87695fdc1d9284ad","30d6e0e27de74c7aa071b32105ffd3a0","8062cf8e6ae245ae9d1984c31522d9da","ae0a9909aa5c4e6ea5d559d8ea642d82","45f3aecd729948b18fddeb3fea8bcce3","f9a3057c6f5148398bc4b40873ce04d2"]},"executionInfo":{"status":"ok","timestamp":1620064803346,"user_tz":420,"elapsed":9668,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}},"outputId":"894d7713-ba6a-4601-aec5-37b2533245c3"},"source":["from transformers import AutoModelForSeq2SeqLM, DataCollatorForSeq2Seq, Seq2SeqTrainingArguments, Seq2SeqTrainer\n","\n","model = AutoModelForSeq2SeqLM.from_pretrained(model_checkpoint)"],"execution_count":61,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"274deb52a9b6465c8c1e9e199cb62f22","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=242065649.0, style=ProgressStyle(descri…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"CczA5lJlIrJX"},"source":["Note that  we don't get a warning like in our classification example. This means we used all the weights of the pretrained model and there is no randomly initialized head in this case."]},{"cell_type":"markdown","metadata":{"id":"_N8urzhyIrJY"},"source":["To instantiate a `Seq2SeqTrainer`, we will need to define three more things. The most important is the [`Seq2SeqTrainingArguments`](https://huggingface.co/transformers/main_classes/trainer.html#transformers.Seq2SeqTrainingArguments), which is a class that contains all the attributes to customize the training. It requires one folder name, which will be used to save the checkpoints of the model, and all other arguments are optional:"]},{"cell_type":"code","metadata":{"id":"Bliy8zgjIrJY","executionInfo":{"status":"ok","timestamp":1620066165270,"user_tz":420,"elapsed":304,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}}},"source":["batch_size = 16\n","args = Seq2SeqTrainingArguments(\n","    \"test-summarization\",\n","    evaluation_strategy = \"epoch\",\n","    learning_rate=2e-5,\n","    per_device_train_batch_size=batch_size,\n","    per_device_eval_batch_size=batch_size,\n","    weight_decay=0.01,\n","    save_total_limit=3,\n","    num_train_epochs=1,\n","    predict_with_generate=True,\n","    fp16=False\n",")"],"execution_count":63,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"km3pGVdTIrJc"},"source":["Here we set the evaluation to be done at the end of each epoch, tweak the learning rate, use the `batch_size` defined at the top of the cell and customize the weight decay. Since the `Seq2SeqTrainer` will save the model regularly and our dataset is quite large, we tell it to make three saves maximum. Lastly, we use the `predict_with_generate` option (to properly generate summaries) and activate mixed precision training (to go a bit faster).\n","\n","Then, we need a special kind of data collator, which will not only pad the inputs to the maximum length in the batch, but also the labels:"]},{"cell_type":"code","metadata":{"id":"7ZQGmK3_lQ0d","executionInfo":{"status":"ok","timestamp":1620066175598,"user_tz":420,"elapsed":662,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}}},"source":["data_collator = DataCollatorForSeq2Seq(tokenizer, model = model)"],"execution_count":64,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"7sZOdRlRIrJd"},"source":["The last thing to define for our `Seq2SeqTrainer` is how to compute the metrics from the predictions. We need to define a function for this, which will just use the `metric` we loaded earlier, and we have to do a bit of pre-processing to decode the predictions into texts:"]},{"cell_type":"code","metadata":{"id":"ZDaunYhReY1v","executionInfo":{"status":"ok","timestamp":1620066276924,"user_tz":420,"elapsed":263,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}}},"source":["def normalize_answer(s):\n","    \"\"\"Lower text and remove punctuation, articles and extra whitespace.\"\"\"\n","\n","    def remove_articles(text):\n","        return re.sub(r\"\\b(a|an|the)\\b\", \" \", text)\n","\n","    def white_space_fix(text):\n","        return \" \".join(text.split())\n","\n","    def remove_punc(text):\n","        exclude = set(string.punctuation)\n","        return \"\".join(ch for ch in text if ch not in exclude)\n","\n","    def lower(text):\n","        return text.lower()\n","\n","    return white_space_fix(remove_articles(remove_punc(lower(s))))\n","\n","\n","def calculate_exact_match_score(prediction, ground_truth):\n","    return int(normalize_answer(prediction) == normalize_answer(ground_truth))\n","\n","\n","def calculate_approx_match_score(prediction, ground_truth):\n","    answer = normalize_answer(prediction) \n","    gt = normalize_answer(ground_truth)\n","    match = 0\n","    gt_words = gt.split(\" \")\n","    for word in gt_words:\n","        if word in answer:\n","            match = 1\n","            return match\n","    return match\n","\n","\n","def calculate_match_score(predictions, ground_truths):\n","    exact_match_score = 0\n","    subset_match_score = 0\n","    for i in range(len(predictions)):\n","        ground_truth = ground_truths[i]\n","        prediction = predictions[i]\n","        exact_match_score +=  calculate_exact_match_score(prediction, ground_truth)\n","        subset_match_score += calculate_approx_match_score(prediction, ground_truth)\n","    \n","    exact_match_score /= len(predictions)\n","    subset_match_score /= len(predictions)\n","    return exact_match_score*100, subset_match_score*100"],"execution_count":65,"outputs":[]},{"cell_type":"code","metadata":{"id":"UmvbnJ9JIrJd"},"source":["# import nltk\n","# import numpy as np\n","\n","# def compute_metrics(eval_pred):\n","#     predictions, labels = eval_pred\n","#     decoded_preds = tokenizer.batch_decode(predictions, skip_special_tokens=True)\n","#     # Replace -100 in the labels as we can't decode them.\n","#     labels = np.where(labels != -100, labels, tokenizer.pad_token_id)\n","#     decoded_labels = tokenizer.batch_decode(labels, skip_special_tokens=True)\n","    \n","#     # Rouge expects a newline after each sentence\n","#     decoded_preds = [\"\\n\".join(nltk.sent_tokenize(pred.strip())) for pred in decoded_preds]\n","#     decoded_labels = [\"\\n\".join(nltk.sent_tokenize(label.strip())) for label in decoded_labels]\n","    \n","#     result = metric.compute(predictions=decoded_preds, references=decoded_labels, use_stemmer=True)\n","#     # Extract a few results\n","#     result = {key: value.mid.fmeasure * 100 for key, value in result.items()}\n","    \n","#     # Add mean generated length\n","#     prediction_lens = [np.count_nonzero(pred != tokenizer.pad_token_id) for pred in predictions]\n","#     result[\"gen_len\"] = np.mean(prediction_lens)\n","    \n","#     return {k: round(v, 4) for k, v in result.items()}"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"rXuFTAzDIrJe"},"source":["Then we just need to pass all of this along with our datasets to the `Seq2SeqTrainer`:"]},{"cell_type":"code","metadata":{"id":"imY1oC3SIrJf","executionInfo":{"status":"ok","timestamp":1620066331061,"user_tz":420,"elapsed":683,"user":{"displayName":"Shikha Aggarwal","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GgbLFl_DtAe7kLNK8ZTwb24_rcGQYRa7vfgz1Pk=s64","userId":"15505266245540489436"}}},"source":["trainer = Seq2SeqTrainer(\n","    model,\n","    args,\n","    train_dataset=tokenized_datasets[\"train\"],\n","    eval_dataset=tokenized_datasets[\"validation\"],\n","    data_collator=data_collator,\n","    tokenizer=tokenizer,\n","    compute_metrics=calculate_match_score\n",")"],"execution_count":66,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"CdzABDVcIrJg"},"source":["We can now finetune our model by just calling the `train` method:"]},{"cell_type":"code","metadata":{"id":"uNx5pyRlIrJh","scrolled":false,"colab":{"base_uri":"https://localhost:8080/","height":133},"outputId":"99860ce9-c09d-46fc-d309-add96dbcbb0e"},"source":["trainer.train()"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","        <style>\n","            /* Turns off some styling */\n","            progress {\n","                /* gets rid of default border in Firefox and Opera. */\n","                border: none;\n","                /* Needs to be in here for Safari polyfill so background images work as expected. */\n","                background-size: auto;\n","            }\n","        </style>\n","      \n","      <progress value='2005' max='8649' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [2005/8649 2:40:25 < 8:52:09, 0.21 it/s, Epoch 0.23/1]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table><p>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"text/html":["\n","    <div>\n","        <style>\n","            /* Turns off some styling */\n","            progress {\n","                /* gets rid of default border in Firefox and Opera. */\n","                border: none;\n","                /* Needs to be in here for Safari polyfill so background images work as expected. */\n","                background-size: auto;\n","            }\n","        </style>\n","      \n","      <progress value='3910' max='8649' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [3910/8649 5:15:40 < 6:22:48, 0.21 it/s, Epoch 0.45/1]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: left;\">\n","      <th>Epoch</th>\n","      <th>Training Loss</th>\n","      <th>Validation Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table><p>"],"text/plain":["<IPython.core.display.HTML object>"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"cCXicraVlQ0e"},"source":[""],"execution_count":null,"outputs":[]}]}